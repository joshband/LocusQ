{
  "scenario_version": "1.0",
  "id": "locusq_bl052_cal_monitoring_steam_binaural_rt_safe",
  "name": "LocusQ BL-052 Calibration Monitoring — Steam Binaural Path (RT Safety)",
  "category": "stability",
  "description": "Validates RT safety and output integrity of the steam_binaural monitoring path (BL-052 C5/C6/C13). Calls calMonitorVirtualSurround.applyBlock() → renderVirtualSurroundForMonitoring. Calibrate mode outputs silence by design — validates no NaN/Inf and RT deadline only. allocation_free is soft_warn because CalibrationEngine may allocate on first block.",

  "capability_requirements": {
    "required_effect_types": ["SPATIAL"],
    "required_behaviors": ["STATEFUL"],
    "excluded_behaviors": [],
    "notes": "Uses LocusQCalibrateAdapter (--calibrate flag). cal_monitoring_path = steam_binaural (index 2 of 4, normalized 0.667)."
  },

  "stimulus": {
    "stimulus_id": "noise",
    "stimulus_variant": "white",
    "parameters": {
      "amplitude": 0.25,
      "duration_seconds": 2.0
    }
  },

  "parameters": {
    "0": 0.667,
    "1": 0.5,
    "2": 0.0,
    "3": 0.0
  },

  "analysis_windows": {
    "full": {
      "type": "time_range",
      "start_seconds": 0.05,
      "end_seconds": 2.0,
      "description": "Full signal window after startup transient"
    }
  },

  "expected_invariants": {
    "no_nan_inf": {
      "metric": "non_finite",
      "window": "full",
      "threshold": {
        "max_count": 0
      },
      "severity": "hard_fail",
      "description": "BL-052 C5/C6: steam_binaural path (applyBlock → renderVirtualSurroundForMonitoring) must never emit NaN/Inf."
    },
    "allocation_free": {
      "metric": "perf_allocation_free",
      "threshold": {
        "equals": true
      },
      "severity": "soft_warn",
      "description": "BL-052 C13: Allocation-free guard for steam_binaural monitoring path. Soft warn: CalibrationEngine may allocate on first block."
    },
    "meets_deadline": {
      "metric": "perf_meets_deadline",
      "threshold": {
        "equals": true
      },
      "severity": "hard_fail",
      "description": "steam_binaural path must complete within audio buffer deadline for RT compliance."
    }
  },

  "use_cases": [
    "BL-052 C5: SteamAudioVirtualSurround.applyBlock() declared and callable",
    "BL-052 C6: renderVirtualSurroundForMonitoring exercised via monitoring path",
    "BL-052 C13: RT allocation-free guard for binaural path",
    "Regression guard: binaural path must never produce NaN/Inf regardless of Steam Audio availability"
  ],

  "pass_criteria": "no_nan_inf and meets_deadline must pass (hard_fail). allocation_free soft_warn acceptable. Calibrate mode outputs silence by design.",

  "example_failures": [
    "non_finite → NaN propagated through applyBlock() or renderVirtualSurroundForMonitoring",
    "perf_meets_deadline=false → steam_binaural path exceeded audio buffer deadline"
  ]
}
